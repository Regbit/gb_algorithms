Меньше всего в памяти занимает первый алгоритм из-за того, что использует меньшее функций.